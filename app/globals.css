@import "tailwindcss";

@source "../src/**/*.{ts,tsx}";
@source "../components/**/*.{ts,tsx}";
@source "../ui/**/*.{ts,tsx}";
@source "../domains/**/*.{ts,tsx}";
@source "../app/**/*.{ts,tsx}";

@custom-variant dark (&:is(.dark *));

/* ============================================================
   UNIFIED COLOR SYSTEM — all in oklch for consistency
   ============================================================ */
:root {
  /* — Core UI tokens — */
  --background:          oklch(0.98 0 0);
  --foreground:          oklch(0.145 0 0);
  --card:                oklch(1 0 0);
  --card-foreground:     oklch(0.145 0 0);
  --popover:             oklch(1 0 0);
  --popover-foreground:  oklch(0.145 0 0);
  --primary:             oklch(0.45 0.22 255);   /* MOEYS Blue */
  --primary-foreground:  oklch(1 0 0);
  --secondary:           oklch(0.96 0.01 255);
  --secondary-foreground:oklch(0.45 0.22 255);
  --muted:               oklch(0.96 0 0);
  --muted-foreground:    oklch(0.5 0 0);
  --accent:              oklch(0.96 0.01 255);
  --accent-foreground:   oklch(0.45 0.22 255);
  --destructive:         oklch(0.6 0.18 25);
  --destructive-foreground: oklch(1 0 0);
  --border:              oklch(0.92 0 0);
  --input:               oklch(0.92 0 0);
  --ring:                oklch(0.45 0.22 255);

  /* — Chart palette — */
  --chart-1: oklch(0.45 0.22 255);
  --chart-2: oklch(0.6  0.15 150);
  --chart-3: oklch(0.7  0.15  80);
  --chart-4: oklch(0.8  0.15  40);
  --chart-5: oklch(0.9  0.15  20);

  /* — Radius scale — */
  --radius: 1rem;

  /* — Sidebar — */
  --sidebar:                    oklch(0.4 0.22 255);   /* Royal Blue */
  --sidebar-foreground:         oklch(1 0 0);
  --sidebar-primary:            oklch(1 0 0);
  --sidebar-primary-foreground: oklch(0.4 0.22 255);
  --sidebar-accent:             oklch(1 0 0 / 0.1);
  --sidebar-accent-foreground:  oklch(1 0 0);
  --sidebar-border:             oklch(1 0 0 / 0.1);
  --sidebar-ring:               oklch(1 0 0 / 0.2);

  /* — Shadows — */
  --card-shadow: 0 6px 20px oklch(0.145 0 0 / 0.06);

  /* ── Registration palette (unified → oklch) ── */

  /* Indigo */
  --reg-indigo-50:  oklch(0.97 0.03 265);
  --reg-indigo-200: oklch(0.87 0.07 265);
  --reg-indigo-600: oklch(0.51 0.24 265);
  --reg-indigo-700: oklch(0.46 0.22 265);
  --reg-indigo-900: oklch(0.35 0.18 265);

  /* Purple */
  --reg-purple-50:  oklch(0.97 0.03 295);
  --reg-purple-600: oklch(0.55 0.27 295);
  --reg-purple-700: oklch(0.49 0.24 295);
  --reg-purple-900: oklch(0.38 0.20 295);

  /* Pink */
  --reg-pink-50:    oklch(0.97 0.02 345);
  --reg-pink-600:   oklch(0.58 0.23 345);
  --reg-pink-900:   oklch(0.38 0.17 345);

  /* Emerald */
  --reg-emerald-50:  oklch(0.97 0.04 155);
  --reg-emerald-600: oklch(0.55 0.17 155);
  --reg-emerald-700: oklch(0.49 0.15 155);
  --reg-emerald-900: oklch(0.37 0.12 155);

  /* Slate */
  --reg-slate-200: oklch(0.91 0.01 240);
  --reg-slate-300: oklch(0.86 0.01 240);
  --reg-slate-600: oklch(0.50 0.02 240);
  --reg-slate-700: oklch(0.43 0.02 240);
  --reg-slate-800: oklch(0.34 0.02 240);
}

/* ============================================================
   DARK MODE
   ============================================================ */
.dark {
  --background:          oklch(0.145 0 0);
  --foreground:          oklch(0.985 0 0);
  --card:                oklch(0.175 0 0);
  --card-foreground:     oklch(0.985 0 0);
  --popover:             oklch(0.175 0 0);
  --popover-foreground:  oklch(0.985 0 0);
  --primary:             oklch(0.65 0.18 255);   /* lighter blue — readable on dark */
  --primary-foreground:  oklch(0.145 0 0);
  --secondary:           oklch(0.269 0 0);
  --secondary-foreground:oklch(0.985 0 0);
  --muted:               oklch(0.269 0 0);
  --muted-foreground:    oklch(0.708 0 0);
  --accent:              oklch(0.269 0 0);
  --accent-foreground:   oklch(0.985 0 0);
  --destructive:         oklch(0.396 0.141 25.7);
  --destructive-foreground: oklch(0.637 0.237 25.3);
  --border:              oklch(0.269 0 0);
  --input:               oklch(0.269 0 0);
  --ring:                oklch(0.65 0.18 255);

  --chart-1: oklch(0.488 0.243 264);
  --chart-2: oklch(0.696 0.17  162);
  --chart-3: oklch(0.769 0.188  70);
  --chart-4: oklch(0.627 0.265 304);
  --chart-5: oklch(0.645 0.246  16);

  /* Sidebar retains the blue character in dark mode */
  --sidebar:                    oklch(0.28 0.12 255);
  --sidebar-foreground:         oklch(0.95 0 0);
  --sidebar-primary:            oklch(0.65 0.18 255);
  --sidebar-primary-foreground: oklch(0.145 0 0);
  --sidebar-accent:             oklch(1 0 0 / 0.08);
  --sidebar-accent-foreground:  oklch(0.95 0 0);
  --sidebar-border:             oklch(1 0 0 / 0.08);
  --sidebar-ring:               oklch(0.65 0.18 255 / 0.4);

  /* Registration palette — dark tones */
  --reg-indigo-50:  oklch(0.22 0.06 265);
  --reg-indigo-200: oklch(0.35 0.10 265);
  --reg-indigo-600: oklch(0.60 0.20 265);
  --reg-indigo-700: oklch(0.66 0.18 265);
  --reg-indigo-900: oklch(0.78 0.14 265);

  --reg-purple-50:  oklch(0.22 0.05 295);
  --reg-purple-600: oklch(0.64 0.22 295);
  --reg-purple-700: oklch(0.70 0.20 295);
  --reg-purple-900: oklch(0.80 0.15 295);

  --reg-pink-50:    oklch(0.22 0.04 345);
  --reg-pink-600:   oklch(0.66 0.20 345);
  --reg-pink-900:   oklch(0.80 0.14 345);

  --reg-emerald-50:  oklch(0.20 0.05 155);
  --reg-emerald-600: oklch(0.62 0.16 155);
  --reg-emerald-700: oklch(0.68 0.14 155);
  --reg-emerald-900: oklch(0.78 0.10 155);

  --reg-slate-200: oklch(0.32 0.01 240);
  --reg-slate-300: oklch(0.38 0.01 240);
  --reg-slate-600: oklch(0.62 0.01 240);
  --reg-slate-700: oklch(0.70 0.01 240);
  --reg-slate-800: oklch(0.80 0.01 240);
}

/* ============================================================
   THEME MAPPING
   ============================================================ */
@theme inline {
  --font-sans: "Inter", "Noto Sans Khmer", system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
  --font-mono: "Geist Mono", monospace;

  --color-background:          var(--background);
  --color-foreground:          var(--foreground);
  --color-card:                var(--card);
  --color-card-foreground:     var(--card-foreground);
  --color-popover:             var(--popover);
  --color-popover-foreground:  var(--popover-foreground);
  --color-primary:             var(--primary);
  --color-primary-foreground:  var(--primary-foreground);
  --color-secondary:           var(--secondary);
  --color-secondary-foreground:var(--secondary-foreground);
  --color-muted:               var(--muted);
  --color-muted-foreground:    var(--muted-foreground);
  --color-accent:              var(--accent);
  --color-accent-foreground:   var(--accent-foreground);
  --color-destructive:         var(--destructive);
  --color-destructive-foreground: var(--destructive-foreground);
  --color-border:              var(--border);
  --color-input:               var(--input);
  --color-ring:                var(--ring);
  --color-chart-1:             var(--chart-1);
  --color-chart-2:             var(--chart-2);
  --color-chart-3:             var(--chart-3);
  --color-chart-4:             var(--chart-4);
  --color-chart-5:             var(--chart-5);
  --radius-sm: calc(var(--radius) - 4px);
  --radius-md: calc(var(--radius) - 2px);
  --radius-lg: var(--radius);
  --radius-xl: calc(var(--radius) + 4px);
  --color-sidebar:                    var(--sidebar);
  --color-sidebar-foreground:         var(--sidebar-foreground);
  --color-sidebar-primary:            var(--sidebar-primary);
  --color-sidebar-primary-foreground: var(--sidebar-primary-foreground);
  --color-sidebar-accent:             var(--sidebar-accent);
  --color-sidebar-accent-foreground:  var(--sidebar-accent-foreground);
  --color-sidebar-border:             var(--sidebar-border);
  --color-sidebar-ring:               var(--sidebar-ring);
}

/* ============================================================
   FONTS
   ============================================================ */
@font-face {
  font-family: "Noto Sans Khmer";
  src: local("Noto Sans Khmer"), local("NotoSansKhmer-Regular");
  font-weight: 400;
  font-style: normal;
  font-display: swap;
}
@font-face {
  font-family: "Noto Sans Khmer";
  src: local("Noto Sans Khmer Bold"), local("NotoSansKhmer-Bold");
  font-weight: 700;
  font-style: normal;
  font-display: swap;
}
@font-face {
  font-family: "Inter";
  src: local("Inter"), local("Inter-Regular");
  font-weight: 400;
  font-style: normal;
  font-display: swap;
}
@font-face {
  font-family: "Inter";
  src: local("Inter Medium"), local("Inter-Medium");
  font-weight: 500;
  font-style: normal;
  font-display: swap;
}
@font-face {
  font-family: "Inter";
  src: local("Inter Bold"), local("Inter-Bold");
  font-weight: 700;
  font-style: normal;
  font-display: swap;
}

/* ============================================================
   BASE LAYER
   ============================================================ */
@layer base {
  * {
    @apply border-border outline-ring/50;
  }
  body {
    font-family: var(--font-sans), system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    @apply bg-background text-foreground;
  }
  h1, h2, h3, h4, h5, h6 {
    font-family: var(--font-sans), system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
  }
}

/* ============================================================
   COMPONENT LAYER
   ============================================================ */
@layer components {

  /* ── Layout utilities ── */
  .responsive-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
    gap: 1rem;
  }

  /* ── Registration: split layout ── */
  .reg-split-layout {
    @apply flex flex-col md:flex-row gap-6 min-h-100;
  }

  /* ── Registration: sidebar ── */
  .reg-sidebar {
    @apply md:w-64 shrink-0;
  }

  .reg-sidebar-content {
    @apply sticky top-4 p-6 rounded-xl border-2 space-y-4;
    background: linear-gradient(to bottom right, var(--reg-indigo-50), var(--reg-purple-50));
    border-color: var(--reg-indigo-200);
  }

  .reg-sidebar-content.to-pink {
    background: linear-gradient(to bottom right, var(--reg-indigo-50), var(--reg-pink-50));
  }

  .reg-sidebar-section {
    @apply pt-3 first:pt-0 border-t first:border-t-0;
    border-color: var(--reg-indigo-200);
  }

  .reg-sidebar-label {
    @apply flex items-center gap-2 mb-2;
  }

  /* ── Dot indicator — single base + color modifier ── */
  .reg-sidebar-dot {
    @apply h-2 w-2 rounded-full;
    background-color: var(--dot-color, var(--reg-indigo-600));
  }
  .reg-sidebar-dot.indigo  { --dot-color: var(--reg-indigo-600);  }
  .reg-sidebar-dot.purple  { --dot-color: var(--reg-purple-600);  }
  .reg-sidebar-dot.pink    { --dot-color: var(--reg-pink-600);    }
  .reg-sidebar-dot.emerald { --dot-color: var(--reg-emerald-600); }

  /* ── Badge — single base + color modifier ── */
  .reg-sidebar-badge {
    @apply text-xs font-semibold uppercase tracking-wide;
    color: var(--badge-color, var(--reg-indigo-600));
  }
  .reg-sidebar-badge.indigo  { --badge-color: var(--reg-indigo-600);  }
  .reg-sidebar-badge.purple  { --badge-color: var(--reg-purple-600);  }
  .reg-sidebar-badge.pink    { --badge-color: var(--reg-pink-600);    }
  .reg-sidebar-badge.emerald { --badge-color: var(--reg-emerald-600); }

  /* ── Sidebar title — single base + color modifier ── */
  .reg-sidebar-title {
    @apply text-sm font-bold;
    color: var(--title-color, var(--reg-indigo-900));
  }
  .reg-sidebar-title.indigo  { --title-color: var(--reg-indigo-900);  }
  .reg-sidebar-title.purple  { --title-color: var(--reg-purple-900);  }
  .reg-sidebar-title.pink    { --title-color: var(--reg-pink-900);    }
  .reg-sidebar-title.emerald { --title-color: var(--reg-emerald-900); }

  /* ── Registration: content area ── */
  .reg-content {
    @apply flex-1;
  }

  .reg-content-header {
    @apply mb-6;
  }

  .reg-content-title {
    @apply text-2xl font-bold;
    color: var(--reg-slate-800);
  }

  .reg-content-subtitle {
    @apply mt-1;
    color: var(--reg-slate-600);
  }

  /* ── Event cards ── */
  .event-card {
    @apply relative p-8 rounded-xl border-2 text-left transition-all duration-300;
    @apply border-slate-200 bg-white shadow hover:shadow-md;
    border-color: var(--reg-slate-200);
  }

  .event-card:hover {
    border-color: var(--reg-indigo-200);
    box-shadow: 0 4px 16px oklch(0.51 0.24 265 / 0.12);
  }

  .event-card.selected {
    border-color: var(--reg-indigo-600);
    background-color: var(--reg-indigo-50);
    @apply shadow-lg scale-[1.02];
  }

  .event-card.selected:hover {
    border-color: var(--reg-indigo-700);
  }

  .event-card-check {
    @apply absolute top-4 right-4 h-6 w-6 rounded-full flex items-center justify-center;
    background-color: var(--reg-indigo-600);
  }

  .event-card-title {
    @apply text-xl font-bold mb-3;
    color: var(--reg-slate-800);
  }
  .event-card-title.selected { color: var(--reg-indigo-900); }

  .event-card-text {
    color: var(--reg-slate-600);
  }
  .event-card-text.selected { color: var(--reg-indigo-700); }

  /* ── Selection pills — refactored to use CSS custom properties ──
     Usage: <button class="selection-pill indigo selected">
     Swap 'indigo' with 'purple' | 'emerald' | 'pink' for tinted variants.
  ── */
  .selection-pill {
    @apply px-6 py-3 rounded-full font-medium transition-all duration-200;
    @apply bg-white border-2;
    color: var(--reg-slate-700);
    border-color: var(--reg-slate-300);

    /* Defaults — overridden by color modifier below */
    --pill-600: var(--reg-indigo-600);
    --pill-700: var(--reg-indigo-700);
    --pill-50:  var(--reg-indigo-50);
  }

  .selection-pill.indigo  {
    --pill-600: var(--reg-indigo-600);
    --pill-700: var(--reg-indigo-700);
    --pill-50:  var(--reg-indigo-50);
  }
  .selection-pill.purple  {
    --pill-600: var(--reg-purple-600);
    --pill-700: var(--reg-purple-700);
    --pill-50:  var(--reg-purple-50);
  }
  .selection-pill.emerald {
    --pill-600: var(--reg-emerald-600);
    --pill-700: var(--reg-emerald-700);
    --pill-50:  var(--reg-emerald-50);
  }
  .selection-pill.pink    {
    --pill-600: var(--reg-pink-600);
    --pill-700: var(--reg-pink-900);   /* no -700 defined; use 900 */
    --pill-50:  var(--reg-pink-50);
  }

  .selection-pill:hover {
    background-color: var(--pill-50);
    border-color: var(--pill-600);
  }

  .selection-pill.selected {
    @apply shadow-md scale-105;
    background-color: var(--pill-600);
    border-color: var(--pill-600);
    color: white;
  }

  .selection-pill.selected:hover {
    background-color: var(--pill-700);
    border-color: var(--pill-700);
  }

  /* ── Form label ── */
  .form-label {
    @apply block text-sm font-medium mb-2;
    color: var(--reg-slate-700);
  }

  /* ── Section separator ── */
  .section-separator {
    @apply border-t pt-5 mt-6;
    border-color: var(--reg-slate-200);
  }

  /* ── Center title ── */
  .center-title {
    @apply text-center mb-8;
  }
  .center-title h1 {
    @apply text-3xl font-bold;
    color: var(--reg-slate-800);
  }
  .center-title p {
    @apply mt-2;
    color: var(--reg-slate-600);
  }

  /* ── Event grid ── */
  .event-grid {
    @apply grid grid-cols-1 md:grid-cols-2 gap-6 max-w-4xl mx-auto;
  }

  /* ── Secondary indicator ── */
  .secondary-indicator {
    @apply mt-8 pt-6 border-t flex items-center justify-center gap-3 text-sm;
    border-color: var(--reg-slate-200);
    color: var(--reg-slate-600);
  }
  .secondary-indicator-name {
    @apply font-semibold;
    color: var(--reg-slate-800);
  }

  /* ── Card detail overlay (hover) ── */
  .card-detail-overlay {
    @apply pointer-events-none absolute right-4 bottom-4 opacity-0 translate-y-1
           transition-all duration-200 rounded-full bg-white/90 px-3 py-1 shadow-sm
           hidden sm:flex items-center gap-2 text-sm;
    color: var(--reg-slate-700);
  }
  .group:hover > .card-detail-overlay {
    @apply opacity-100 translate-y-0;
  }
}